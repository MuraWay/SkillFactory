Задание 4.1

База данных содержит список аэропортов практически всех крупных городов России. В большинстве городов есть только один аэропорт. Исключение составляет:
Moscow, Ulyanovsk

SELECT a.city,
       count(*)
FROM dst_project.AIRPORTS a
GROUP BY a.city
ORDER BY 2 DESC
-- Ответ: Moscow, Ulyanovsk


Задание 4.2

Вопрос 1. Таблица рейсов содержит всю информацию о прошлых, текущих и запланированных рейсах. 
Сколько всего статусов для рейсов определено в таблице?

SELECT count(DISTINCT f.status)
FROM dst_project.FLIGHTS f
-- Ответ: 6
 
 
Вопрос 2. Какое количество самолетов находятся в воздухе на момент среза в базе (статус рейса «самолёт уже вылетел и находится в воздухе»).

-- Вариант 1 - по статусу
SELECT count(f.flight_id)
FROM dst_project.FLIGHTS f
WHERE f.status = 'Departed'
-- Ответ: 58
 
-- Вариант 2 - есть фактическое время вылета и нет факт. времени прилёта
SELECT count(f.flight_id)
FROM dst_project.FLIGHTS f
WHERE f.actual_departure IS NOT NULL
  AND f.actual_arrival IS NULL
-- Ответ: 58


Вопрос 3. Места определяют схему салона каждой модели. Сколько мест имеет самолет модели 773 (Boeing 777-300)?

SELECT a.model,
       count(s.seat_no)
FROM dst_project.AIRCRAFTS a
JOIN dst_project.SEATS s ON a.aircraft_code=s.aircraft_code
WHERE a.model = 'Boeing 777-300'
GROUP BY 1
-- Ответ: 402


Вопрос 4. Сколько состоявшихся (фактических) рейсов было совершено между 1 апреля 2017 года и 1 сентября 2017 года?
Здесь и далее состоявшийся рейс означает, что он не отменён, и самолёт прибыл в пункт назначения.

